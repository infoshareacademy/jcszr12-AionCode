@using Database.EnumTypes
@model CookBook.BuisnesLogic.DTO.RecipeDetailsDTO

@{
    ViewData["Title"] = "Create Recipe";
    //Setting up Type dropdownlsit
    var enumSelectList = new SelectList(Enum.GetValues(typeof(IngredientType)));
   
}

<head>
    <style>
        .btn {
            color: black;
            background: #FFC107;
        }

            .btn:hover {
                color: black;
                background: orange;
            }
    </style>
</head>

<h1 class="text-center bg-transparent">Dodaj nowy przepis</h1>

<hr />

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <form asp-action="Create">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <div class="form-group">
                    <label asp-for="Name" class="control-label">Nazwa Dania:</label>
                    <input asp-for="Name" class="form-control" />
                    <span asp-validation-for="Name" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="Category" class="control-label">Kategoria:</label>
                    <input asp-for="Category" class="form-control" />
                    <span asp-validation-for="Category" class="text-danger"></span>
                </div>                
                <div class="form-group">
                    <label asp-for="Description" class="control-label">Opis przygotowania:</label>
                    <textarea asp-for="Description" class="form-control"></textarea>
                    <span asp-validation-for="Description" class="text-danger"></span>
                </div>

                <div style="margin-bottom: 10px;">
                    <form id="addIngredientForm">
                        <label for="ingredientName">Nazwa składnika:</label>
                        <input type="text" id="ingredientName" name="ingredientName" placeholder="Nazwa składnika" required />
                        <label for="weight">Waga:</label>
                        <input type="number" id="weight" name="weight" placeholder="Waga (g)" required />
                        <button type="button" id="addIngredientBtn" class="btn">Dodaj składnik</button>
                    </form>
                </div>

                <div class="form-group">
                    <input type="submit" value="Utwórz" class="btn btn-primary" />
                </div>
            </form>
        </div>
    </div>
</div>

<div class="text-center">
    <a asp-action="Index" class="btn btn-secondary mt-3">Powrót</a>
</div>

@section scripts {
    <script>
        $(document).ready(function () {
            $("#addIngredientBtn").click(function () {
                var ingredientName = $("#ingredientName").val();
                var weight = $("#weight").val();
                var ingredientUsed = @Html.;
                // Wyślij zapytanie AJAX do kontrolera, aby dodać składnik
                $.ajax({
                    url: '@Url.Action("AddIngredient", "Recipe")',
                    method: 'POST',
                    data: { ingredientName: ingredientName, weight: weight },
                    success: function (response) {
                        // Jeśli dodano składnik, możesz dodać odpowiedni kod obsługujący sukces
                        // Na przykład wyświetlenie komunikatu lub zaktualizowanie listy składników
                    },
                    error: function (error) {
                        // Obsługa błędu, jeśli wystąpił problem podczas dodawania składnika
                    }
                });
            });
        });
    </script>
}
@* @section scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
}
    <script>
        $(document).ready(function () {
            // Inicjalizacja Autocomplete dla każdego pola nazwy składnika
            $("input[name='ingredientName']").each(function () {
                var fridgeId = $(this).attr("id").split("_")[1];
                $(this).autocomplete({
                    source: function (request, response) {
                        $.ajax({
                            url: '@Url.Action("SearchIngredients", "MyFridge")',
                            data: { term: request.term },
                            success: function (data) {
                                response(data.map(function (item) {
                                    return {
                                        label: item.name,
                                        value: item.name,
                                        id: item.id
                                    };
                                }));
                            }
                        });
                    },
                    minLength: 2 // Minimalna liczba znaków do uruchomienia autouzupełniania
                });
            });
        });
    </script> *@
